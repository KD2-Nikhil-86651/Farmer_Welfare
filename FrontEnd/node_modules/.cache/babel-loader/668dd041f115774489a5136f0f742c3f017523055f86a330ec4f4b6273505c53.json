{"ast":null,"code":"import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\n// function AllFarmer() {\n//   const [farmers, setFarmers] = useState([]);\n\n//   useEffect(() => {\n//     fetchFarmers();\n//   }, []);\n\n//   const fetchFarmers = async () => {\n//     try {\n//       const response = await axios.get(\"https://localhost:7299/api/Farmer\");\n//       setFarmers(response.data);\n//     } catch (error) {\n//       console.error(\"Error fetching farmers:\", error);\n//     }\n//   };\n\n//   const handleDelete = async (farmerId) => {\n//     try {\n//       await axios.delete(`https://localhost:7299/api/Farmers/${farmerId}`);\n//       setFarmers(farmers.filter((farmer) => farmer.userID !== farmerId));\n//       alert(\"Farmer deleted successfully!\");\n//     } catch (error) {\n//       console.error(\"Error deleting farmer:\", error);\n//     }\n//   };\n\n//   return (\n//     <div className=\"container\">\n//       <h2 className=\"mt-4\">All Farmers</h2>\n//       <table className=\"table table-bordered mt-3\">\n//         <thead className=\"bg-primary text-white\">\n//           <tr>\n//             <th>ID</th>\n//             <th>Name</th>\n//             <th>Email</th>\n//             <th>Contact No</th>\n//             <th>Actions</th>\n//           </tr>\n//         </thead>\n//         <tbody>\n//           {farmers.length > 0 ? (\n//             farmers.map((farmer) => (\n//               <tr key={farmer.userID}>\n//                 <td>{farmer.userID}</td>\n//                 <td>\n//                   {farmer.firstName} {farmer.lastName}\n//                 </td>\n//                 <td>{farmer.email}</td>\n//                 <td>{farmer.contactNo}</td>\n//                 <td>\n//                   <button\n//                     className=\"btn btn-danger\"\n//                     onClick={() => handleDelete(farmer.userID)}\n//                   >\n//                     Delete\n//                   </button>\n//                 </td>\n//               </tr>\n//             ))\n//           ) : (\n//             <tr>\n//               <td colSpan=\"5\" className=\"text-center\">\n//                 No farmers available.\n//               </td>\n//             </tr>\n//           )}\n//         </tbody>\n//       </table>\n//     </div>\n//   );\n// }\n\n// // export default AllFarmer;\n\n// import React, { useEffect, useState } from \"react\";\n// import Navbar from \"../components/Navbar\";\n// import axios from \"axios\";\n\n// function AllFarmer() {\n//   const [farmers, setFarmers] = useState([]);\n\n//   // Fetch farmers from the backend\n//   const fetchFarmers = async () => {\n//     try {\n//       const token = sessionStorage.getItem(\"token\");\n//       const response = await axios.get(\"https://localhost:7299/api/Farmer\", {\n//         headers: { Authorization: `Bearer ${token}` },\n//       });\n//       setFarmers(response.data);\n//     } catch (error) {\n//       console.error(\"Error fetching farmers:\", error);\n//     }\n//   };\n\n//   useEffect(() => {\n//     fetchFarmers(); // Fetch farmers on component mount\n//   }, []);\n\n//   return (\n//     <div className=\"container\">\n//       <Navbar />\n//       <h2 className=\"mt-4\">All Farmers</h2>\n//       <table className=\"table table-bordered mt-3\">\n//         <thead className=\"table-dark\">\n//           <tr>\n//             <th>ID</th>\n//             <th>Name</th>\n//             <th>Email</th>\n//             <th>Contact No</th>\n//           </tr>\n//         </thead>\n//         <tbody>\n//           {farmers.length > 0 ? (\n//             farmers.map((farmer) => (\n//               <tr key={farmer.farmerId}>\n//                 <td>{farmer.farmerId}</td>\n//                 <td>{farmer.firstName} {farmer.lastName}</td>\n//                 <td>{farmer.email}</td>\n//                 <td>{farmer.contactNo}</td>\n//               </tr>\n//             ))\n//           ) : (\n//             <tr>\n//               <td colSpan=\"4\" className=\"text-center\">\n//                 No farmers available.\n//               </td>\n//             </tr>\n//           )}\n//         </tbody>\n//       </table>\n//     </div>\n//   );\n// }\n\n// export default AllFarmer;\n\nconst fetchFarmers = async () => {\n  try {\n    const token = sessionStorage.getItem(\"token\");\n    if (!token) {\n      console.error(\"No token found. Redirecting to login.\");\n      return; // Stop execution if no token\n    }\n    const response = await axios.get(\"https://localhost:7299/api/Farmer\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    setFarmers(response.data);\n  } catch (error) {\n    console.error(\"Error fetching farmers:\", error);\n    if (error.response && error.response.status === 401) {\n      alert(\"Unauthorized! Please log in again.\");\n      sessionStorage.clear();\n      window.location.href = \"/Login\"; // Redirect to login page\n    }\n  }\n};","map":{"version":3,"names":["React","useEffect","useState","axios","fetchFarmers","token","sessionStorage","getItem","console","error","response","get","headers","Authorization","setFarmers","data","status","alert","clear","window","location","href"],"sources":["D:/Nikhil/Downloads/CDAC Project/FarmerFrontend/src/screens/AllFarmer.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\n// function AllFarmer() {\r\n//   const [farmers, setFarmers] = useState([]);\r\n\r\n//   useEffect(() => {\r\n//     fetchFarmers();\r\n//   }, []);\r\n\r\n//   const fetchFarmers = async () => {\r\n//     try {\r\n//       const response = await axios.get(\"https://localhost:7299/api/Farmer\");\r\n//       setFarmers(response.data);\r\n//     } catch (error) {\r\n//       console.error(\"Error fetching farmers:\", error);\r\n//     }\r\n//   };\r\n\r\n//   const handleDelete = async (farmerId) => {\r\n//     try {\r\n//       await axios.delete(`https://localhost:7299/api/Farmers/${farmerId}`);\r\n//       setFarmers(farmers.filter((farmer) => farmer.userID !== farmerId));\r\n//       alert(\"Farmer deleted successfully!\");\r\n//     } catch (error) {\r\n//       console.error(\"Error deleting farmer:\", error);\r\n//     }\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"container\">\r\n//       <h2 className=\"mt-4\">All Farmers</h2>\r\n//       <table className=\"table table-bordered mt-3\">\r\n//         <thead className=\"bg-primary text-white\">\r\n//           <tr>\r\n//             <th>ID</th>\r\n//             <th>Name</th>\r\n//             <th>Email</th>\r\n//             <th>Contact No</th>\r\n//             <th>Actions</th>\r\n//           </tr>\r\n//         </thead>\r\n//         <tbody>\r\n//           {farmers.length > 0 ? (\r\n//             farmers.map((farmer) => (\r\n//               <tr key={farmer.userID}>\r\n//                 <td>{farmer.userID}</td>\r\n//                 <td>\r\n//                   {farmer.firstName} {farmer.lastName}\r\n//                 </td>\r\n//                 <td>{farmer.email}</td>\r\n//                 <td>{farmer.contactNo}</td>\r\n//                 <td>\r\n//                   <button\r\n//                     className=\"btn btn-danger\"\r\n//                     onClick={() => handleDelete(farmer.userID)}\r\n//                   >\r\n//                     Delete\r\n//                   </button>\r\n//                 </td>\r\n//               </tr>\r\n//             ))\r\n//           ) : (\r\n//             <tr>\r\n//               <td colSpan=\"5\" className=\"text-center\">\r\n//                 No farmers available.\r\n//               </td>\r\n//             </tr>\r\n//           )}\r\n//         </tbody>\r\n//       </table>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// // export default AllFarmer;\r\n\r\n\r\n// import React, { useEffect, useState } from \"react\";\r\n// import Navbar from \"../components/Navbar\";\r\n// import axios from \"axios\";\r\n\r\n// function AllFarmer() {\r\n//   const [farmers, setFarmers] = useState([]);\r\n\r\n//   // Fetch farmers from the backend\r\n//   const fetchFarmers = async () => {\r\n//     try {\r\n//       const token = sessionStorage.getItem(\"token\");\r\n//       const response = await axios.get(\"https://localhost:7299/api/Farmer\", {\r\n//         headers: { Authorization: `Bearer ${token}` },\r\n//       });\r\n//       setFarmers(response.data);\r\n//     } catch (error) {\r\n//       console.error(\"Error fetching farmers:\", error);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchFarmers(); // Fetch farmers on component mount\r\n//   }, []);\r\n\r\n//   return (\r\n//     <div className=\"container\">\r\n//       <Navbar />\r\n//       <h2 className=\"mt-4\">All Farmers</h2>\r\n//       <table className=\"table table-bordered mt-3\">\r\n//         <thead className=\"table-dark\">\r\n//           <tr>\r\n//             <th>ID</th>\r\n//             <th>Name</th>\r\n//             <th>Email</th>\r\n//             <th>Contact No</th>\r\n//           </tr>\r\n//         </thead>\r\n//         <tbody>\r\n//           {farmers.length > 0 ? (\r\n//             farmers.map((farmer) => (\r\n//               <tr key={farmer.farmerId}>\r\n//                 <td>{farmer.farmerId}</td>\r\n//                 <td>{farmer.firstName} {farmer.lastName}</td>\r\n//                 <td>{farmer.email}</td>\r\n//                 <td>{farmer.contactNo}</td>\r\n//               </tr>\r\n//             ))\r\n//           ) : (\r\n//             <tr>\r\n//               <td colSpan=\"4\" className=\"text-center\">\r\n//                 No farmers available.\r\n//               </td>\r\n//             </tr>\r\n//           )}\r\n//         </tbody>\r\n//       </table>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default AllFarmer;\r\n\r\n\r\nconst fetchFarmers = async () => {\r\n    try {\r\n      const token = sessionStorage.getItem(\"token\");\r\n  \r\n      if (!token) {\r\n        console.error(\"No token found. Redirecting to login.\");\r\n        return; // Stop execution if no token\r\n      }\r\n  \r\n      const response = await axios.get(\"https://localhost:7299/api/Farmer\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n  \r\n      setFarmers(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching farmers:\", error);\r\n      if (error.response && error.response.status === 401) {\r\n        alert(\"Unauthorized! Please log in again.\");\r\n        sessionStorage.clear();\r\n        window.location.href = \"/Login\"; // Redirect to login page\r\n      }\r\n    }\r\n  };\r\n  "],"mappings":"AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;EAC7B,IAAI;IACF,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;IAE7C,IAAI,CAACF,KAAK,EAAE;MACVG,OAAO,CAACC,KAAK,CAAC,uCAAuC,CAAC;MACtD,OAAO,CAAC;IACV;IAEA,MAAMC,QAAQ,GAAG,MAAMP,KAAK,CAACQ,GAAG,CAAC,mCAAmC,EAAE;MACpEC,OAAO,EAAE;QAAEC,aAAa,EAAE,UAAUR,KAAK;MAAG;IAC9C,CAAC,CAAC;IAEFS,UAAU,CAACJ,QAAQ,CAACK,IAAI,CAAC;EAC3B,CAAC,CAAC,OAAON,KAAK,EAAE;IACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,IAAIA,KAAK,CAACC,QAAQ,IAAID,KAAK,CAACC,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;MACnDC,KAAK,CAAC,oCAAoC,CAAC;MAC3CX,cAAc,CAACY,KAAK,CAAC,CAAC;MACtBC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ,CAAC,CAAC;IACnC;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}